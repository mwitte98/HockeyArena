<% provide(:title, @player.name) %>
<h2><a href="http://www.hockeyarena.net/en/index.php?p=public_player_info.inc&id=<%= @player.playerid %>" target="_blank"><%= @player.name %></a></h2>
<h4><%= @player.playertype %>: <%= @player.quality %>/<%= @player.potential %></h4>

<head>
  <script type="text/javascript">
    $(document).ready(function() {
      $('.stadium').each(function() {
        var value = $(this).text();
        if (value >= 240) {
          $(this).addClass('blue');
        }
        else if (value < 240 && value >= 200) {
          $(this).addClass('green');
        }
        else if (value < 200 && value >= 180) {
          $(this).addClass('yellow');
        }
        else if (value < 180 && value >= 150) {
          $(this).addClass('orange');
        }
        else if (value < 150) {
          $(this).addClass('red');
        }
      });
      $('.minutes').each(function() {
        var value = $(this).text();
        if (value >= 30) {
          $(this).addClass('blue');
        }
        else if (value < 30 && value >= 25) {
          $(this).addClass('green');
        }
        else if (value < 25 && value >= 20) {
          $(this).addClass('yellow');
        }
        else if (value < 20 && value >= 10) {
          $(this).addClass('orange');
        }
        else if (value < 10) {
          $(this).addClass('red');
        }
      });
      $('.ai_diff').each(function() {
        var value = $(this).text();
        if (value != 0) {
          $(this).addClass('red');
        }
      });
    });
  </script>
</head>

<table>
<thead>
    <tr>
    <th>AI</th>
    <th>T/R</th>
    <th>Avg Min</th>
    <th>Goa</th>
    <th>Def</th>
    <th>Att</th>
    <th>Sho</th>
    <th>Pas</th>
    <th>Spe</th>
    <th>Str</th>
    <th>SCo</th>
    <th>Exp</th>
    <th>Calc AI</th>
    <th>AI Diff</th>
    <th>Games</th>
    <th>Min</th>
    <th>Date</th>
    </tr>
</thead>
<tbody>
    <% @dates.each_with_index do |date, index| %>
    <tr>
        <% if index >= @dates.count - 1 %>
        <td><%= @player.daily[date][0] %></td>
        <td class="stadium"><%= @player.daily[date][1] %></td>
        <td class="minutes"><%= average_minutes(@player.daily[date]) %></td>
        <td><%= @player.daily[date][2] %></td>
        <td><%= @player.daily[date][3] %></td>
        <td><%= @player.daily[date][4] %></td>
        <td><%= @player.daily[date][5] %></td>
        <td><%= @player.daily[date][6] %></td>
        <td><%= @player.daily[date][7] %></td>
        <td><%= @player.daily[date][8] %></td>
        <td><%= @player.daily[date][9] %></td>
        <td><%= @player.daily[date][10] %></td>
        <% else %>
        <% if @player.daily[date][0] - @player.daily[@dates[index+1]][0] > 0 %>
            <td class="darkgreen"><%= @player.daily[date][0] %></td>
        <% else %>
            <td><%= @player.daily[date][0] %></td>
        <% end %>

        <td class="stadium"><%= @player.daily[date][1] %></td>

        <td class="minutes"><%= average_minutes(@player.daily[date]) %></td>

        <% if @player.daily[date][2].nil? || @player.daily[@dates[index+1]][2].nil? || @player.daily[date][2] - @player.daily[@dates[index+1]][2] < 1 %>
            <td><%= @player.daily[date][2] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][2] %></td>
        <% end %>

        <% if @player.daily[date][3].nil? || @player.daily[@dates[index+1]][3].nil? || @player.daily[date][3] - @player.daily[@dates[index+1]][3] < 1 %>
            <td><%= @player.daily[date][3] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][3] %></td>
        <% end %>

        <% if @player.daily[date][4].nil? || @player.daily[@dates[index+1]][4].nil? || @player.daily[date][4] - @player.daily[@dates[index+1]][4] < 1 %>
            <td><%= @player.daily[date][4] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][4] %></td>
        <% end %>

        <% if @player.daily[date][5].nil? || @player.daily[@dates[index+1]][5].nil? || @player.daily[date][5] - @player.daily[@dates[index+1]][5] < 1 %>
            <td><%= @player.daily[date][5] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][5] %></td>
        <% end %>

        <% if @player.daily[date][6].nil? || @player.daily[@dates[index+1]][6].nil? || @player.daily[date][6] - @player.daily[@dates[index+1]][6] < 1 %>
            <td><%= @player.daily[date][6] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][6] %></td>
        <% end %>

        <% if @player.daily[date][7].nil? || @player.daily[@dates[index+1]][7].nil? || @player.daily[date][7] - @player.daily[@dates[index+1]][7] < 1 %>
            <td><%= @player.daily[date][7] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][7] %></td>
        <% end %>

        <% if @player.daily[date][8].nil? || @player.daily[@dates[index+1]][8].nil? || @player.daily[date][8] - @player.daily[@dates[index+1]][8] < 1 %>
            <td><%= @player.daily[date][8] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][8] %></td>
        <% end %>

        <% if @player.daily[date][9].nil? || @player.daily[@dates[index+1]][9].nil? || @player.daily[date][9] - @player.daily[@dates[index+1]][9] < 1 %>
            <td><%= @player.daily[date][9] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][9] %></td>
        <% end %>

        <% if @player.daily[date][10].nil? || @player.daily[@dates[index+1]][10].nil? || @player.daily[date][10] - @player.daily[@dates[index+1]][10] < 1 %>
            <td><%= @player.daily[date][10] %></td>
        <% else %>
            <td class="darkgreen"><%= @player.daily[date][10] %></td>
        <% end %>
        <% end %>
        <td><%= calculate_ai(@player.daily[date]) %></td>
        <td class="ai_diff"><%= @player.daily[date][0] - calculate_ai(@player.daily[date]) %></td>
        <td><%= @player.daily[date][11] %></td>
        <td><%= @player.daily[date][12] %></td>
        <td><%= date.to_datetime.strftime("%m/%d/%Y %I:%M%p") %></td>
    </tr>
    <% end %>
</tbody>
</table>
<br>
<%= button_to "Delete Player", delete_all_path(:id => @player.id), data: { confirm: "Are you sure you want to delete #{@player.name}?" }, class: "btn btn-md btn-primary" %>
